<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurantes HTML</title>
</head>
<body>
    <h1>Cadastro de Restaurantes</h1>
    <input type="text" id="nome" placeholder="Nome" name="nome"/>
    <input type="text" id="telefone" placeholder="telefone" name="telefone"/>
    <input type="text" id="endereco" placeholder="endereco" name="endereco"/>
    <input type="text" id="cnpj" placeholder="cnpj" name="cnpj"/>
    <input type="text" id="descricao" placeholder="descricao" name="descricao"/>
    <button id="btnSend">Enviar</button>
    <br>
    <input type="text" id="id" placeholder="id" name="id"/>
    <button id="btnDelete">"Excluir"</button>
    <p id="paragrafo_get"></p>
</body>
<script>
    function sendUser(){
        var nome = document.getElementById('nome').value
        var telefone = document.getElementById('telefone').value
        var endereco = document.getElementById('endereco').value
        var cnpj = document.getElementById('cnpj').value
        var descricao = document.getElementById('descricao').value
        console.log(nome)
        var data = {
            nome: nome,
            telefone: telefone,
            endereco: endereco,
            cnpj : cnpj,
            descricao: descricao
        }

        const response = fetch('http://localhost:300/restaurante', {
            method: 'POST',
            headers:{
                'Content-Type' : 'Application/Json'
            },
            body: JSON.stringify(data)
            
        })
    }

    //GET ----------------------------------------------
    async function getRestaurante(){
            const response = await fetch("http://localhost:300/restaurante",{
                method: "GET",
            });
            const data = await response.json() //aguarda uma resposta do get antes de executar um script
            const paragrafos = data.restaurante.map(function(restaurante){
                return '<p>'
                    'ㅤㅤ id :' + restaurante.id + 
                    'ㅤㅤ nome :' + restaurante.nome + 
                    'ㅤㅤ telefone :' + restaurante.telefone + 
                    'ㅤㅤ endereco :' + restaurante.endereco +
                    'ㅤㅤ cnpj :' + restaurante.cnpj +
                    'ㅤㅤ descricao :' + restaurante.descricao + '</p>';
            });

            document.getElementById("paragrafo_get").innerHTML = paragrafos.join("");
            console.log(data.restaurante)
        }
        getRestaurante()

    //DELETE ----------------------------------------------
    function excludeRestaurante(){
            var id = document.getElementById('id').value
        let data = {
                id: id
            };
            const deleta = fetch("http://localhost:300/restaurante", {
            method: "DELETE",
            body: JSON.stringify(data),
            headers: {
              "Content-Type": "Application/Json",
            },
          });
        }

    document.getElementById('btnSend').addEventListener('click', () => sendUser())
    document.getElementById('btnDelete').addEventListener('click', () => excludeRestaurante())
</script>
</html>